{% extends "layout.html" %}
{% block title %}Editor Console{% endblock %}
{% block content %}
<div class="card">
  <h2>Editor Console</h2>
  <p>Create a new article or manage your articles below.</p>
  <form method="post">
    <label>Title<br>
      <input name="title" style="width:100%" required>
    </label>
    <p>
      <label>Content<br>
        <input type="hidden" name="content" id="content-input">
        <div id="quill-editor" style="height:300px;border-radius:6px"> </div>
      </label>
    </p>
    <p>
      <button name="action" value="save" type="submit" class="btn">Save Draft</button>
      <button name="action" value="submit" type="submit" class="btn">Submit for Review</button>
      {% if user and user.role == 'admin' %}
        <button name="action" value="publish" type="submit" class="btn">Publish</button>
      {% endif %}
    </p>
  </form>
</div>

<div class="card" style="margin-top:18px">
  <h3>Your Articles</h3>
  <table style="width:100%;border-collapse:collapse">
    <tr style="border-bottom:1px solid rgba(0,0,0,0.06)"><th style="padding:8px">ID</th><th style="padding:8px">Title</th><th style="padding:8px">Status</th><th style="padding:8px">Actions</th></tr>
    {% for a in my_articles %}
      <tr>
        <td style="padding:8px">{{ a.id }}</td>
        <td style="padding:8px">{{ a.title }}</td>
        <td style="padding:8px">{{ a.status }}</td>
        <td style="padding:8px"><a href="/article/{{ a.id }}/edit" class="btn">Edit</a></td>
      </tr>
    {% else %}
      <tr><td colspan="4" style="padding:8px">No articles yet.</td></tr>
    {% endfor %}
  </table>
</div>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
<script>
  const quill = new Quill('#quill-editor', { theme: 'snow', modules: { toolbar: [['bold','italic','underline'],[{ 'list': 'ordered' }, { 'list': 'bullet' }], ['link','image'], ['clean']] } });
  document.querySelector('form').addEventListener('submit', function(e){
    document.getElementById('content-input').value = quill.root.innerHTML;
  });
</script>
{% endblock %}
